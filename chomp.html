<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ì´ˆì½œë¦¿ ì´˜í”„ - ì»¤ìŠ¤í…€ ëª¨ë“œ</title>
    <style>
        body {
            font-family: 'Malgun Gothic', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-color: #f5f0e6;
            padding-top: 20px;
        }
        h1 { color: #5d4037; }
        #menu {
            background: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            text-align: center;
        }
        .setting-group { margin-bottom: 20px; }
        .setting-group label { display: block; margin-bottom: 8px; font-weight: bold; color: #5d4037; }
        input[type="number"] {
            width: 60px;
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            text-align: center;
        }
        #status { margin: 15px; font-size: 1.3rem; font-weight: bold; color: #795548; }
        #grid {
            display: grid;
            gap: 5px;
            background-color: #3e2723;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 6px 20px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            max-width: 90vw;
            overflow: auto;
        }
        .cell {
            width: 50px;
            height: 50px;
            background-color: #8d6e63;
            border-radius: 3px;
            cursor: pointer;
            transition: 0.2s;
        }
        .cell:hover:not(.eaten) { background-color: #a1887f; }
        .cell.eaten { background-color: rgba(255,255,255,0.1); cursor: default; }
        .cell.poison { background-color: #d32f2f; position: relative; }
        .cell.poison::after {
            content: "â˜ ï¸"; position: absolute; top: 50%; left: 50%;
            transform: translate(-50%, -50%); font-size: 1.2rem;
        }
        button {
            padding: 10px 25px;
            font-size: 1rem;
            background-color: #5d4037;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: 0.2s;
        }
        button:hover { background-color: #3e2723; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <h1>Chomp Game</h1>

    <div id="menu">
        <div class="setting-group">
            <label>íŒ í¬ê¸° ì„¤ì • (í–‰ x ì—´)</label>
            <input type="number" id="rows" value="5" min="2" max="10"> x 
            <input type="number" id="cols" value="7" min="2" max="15">
        </div>
        <div class="setting-group">
            <label>ê²Œì„ ëª¨ë“œ ì„ íƒ</label>
            <button onclick="setupGame('PVP')">ì‚¬ëŒ vs ì‚¬ëŒ</button>
            <button onclick="setupGame('PVC')">ì‚¬ëŒ vs ì»´í“¨í„°</button>
        </div>
    </div>

    <div id="game-area" class="hidden">
        <div id="status"></div>
        <div id="grid"></div>
        <button onclick="backToMenu()">ë©”ë‰´ë¡œ ëŒì•„ê°€ê¸°</button>
    </div>

    <script>
        let ROWS, COLS, currentPlayer, gameOver, gameMode;

        const gridElement = document.getElementById('grid');
        const statusElement = document.getElementById('status');
        const menuElement = document.getElementById('menu');
        const gameArea = document.getElementById('game-area');

        function setupGame(mode) {
            ROWS = parseInt(document.getElementById('rows').value) || 5;
            COLS = parseInt(document.getElementById('cols').value) || 7;
            gameMode = mode;
            currentPlayer = 1;
            gameOver = false;

            // ê·¸ë¦¬ë“œ ë ˆì´ì•„ì›ƒ ì„¤ì •
            gridElement.style.gridTemplateColumns = `repeat(${COLS}, 50px)`;
            
            menuElement.classList.add('hidden');
            gameArea.classList.remove('hidden');
            statusElement.innerText = "í”Œë ˆì´ì–´ 1ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤!";
            
            createBoard();
        }

        function createBoard() {
            gridElement.innerHTML = '';
            for (let r = 0; r < ROWS; r++) {
                for (let c = 0; c < COLS; c++) {
                    const cell = document.createElement('div');
                    cell.classList.add('cell');
                    if (r === 0 && c === 0) cell.classList.add('poison');
                    cell.dataset.row = r;
                    cell.dataset.col = c;
                    cell.onclick = () => handleChomp(r, c);
                    gridElement.appendChild(cell);
                }
            }
        }

        function handleChomp(r, c) {
            if (gameOver || (gameMode === 'PVC' && currentPlayer === 2)) return;
            
            const target = document.querySelector(`[data-row="${r}"][data-col="${c}"]`);
            if (target.classList.contains('eaten')) return;

            processMove(r, c);

            if (!gameOver && gameMode === 'PVC' && currentPlayer === 2) {
                statusElement.innerText = "ì»´í“¨í„°ê°€ ê³ ë¯¼ ì¤‘...";
                setTimeout(computerTurn, 700);
            }
        }

        function processMove(row, col) {
            const cells = document.querySelectorAll('.cell');
            cells.forEach(cell => {
                const r = parseInt(cell.dataset.row);
                const c = parseInt(cell.dataset.col);
                if (r >= row && c >= col) {
                    cell.classList.add('eaten');
                }
            });

            if (row === 0 && col === 0) {
                const loserName = (gameMode === 'PVC' && currentPlayer === 2) ? "ì»´í“¨í„°" : `í”Œë ˆì´ì–´ ${currentPlayer}`;
                statusElement.innerText = `ğŸ’¥ ${loserName}ê°€ ë…ì´ˆì½”ë¥¼ ë¨¹ì—ˆìŠµë‹ˆë‹¤!`;
                gameOver = true;
                return;
            }

            currentPlayer = currentPlayer === 1 ? 2 : 1;
            const nextName = (gameMode === 'PVC' && currentPlayer === 2) ? "ì»´í“¨í„°" : `í”Œë ˆì´ì–´ ${currentPlayer}`;
            statusElement.innerText = `${nextName}ì˜ ì°¨ë¡€ì…ë‹ˆë‹¤.`;
        }

        function computerTurn() {
            if (gameOver) return;
            const available = [];
            document.querySelectorAll('.cell:not(.eaten)').forEach(cell => {
                const r = parseInt(cell.dataset.row);
                const c = parseInt(cell.dataset.col);
                if (r !== 0 || c !== 0) available.push({r, c});
            });

            const choice = available.length > 0 
                ? available[Math.floor(Math.random() * available.length)] 
                : {r: 0, c: 0};
            
            processMove(choice.r, choice.c);
        }

        function backToMenu() {
            menuElement.classList.remove('hidden');
            gameArea.classList.add('hidden');
        }
    </script>
</body>
</html>